{% extends "base.html" %}

{% block head %}

<!-- This svg was generated by Claude-Sonnet-3.7 -->
<svg style="display: none;">
    <symbol id="download-icon" viewBox="0 0 24 24">
        <path d="M12 15l-4-4h2.5V7h3v4H16l-4 4z" fill="rgb(255, 255, 255)"/>
        <path d="M17 18H7v-2H5v4h14v-4h-2v2z" fill="rgb(255, 255, 255)"/>
    </symbol>
</svg>

{% endblock %}

{% block body %}

<div class="flex-container-row-center">
    <div class="flex-column">
        <div class="search-bar-long">
            <form class="search-bar-long" id="search-knowledge-base" method="post">
                <div class="flex-container-row-center">
                    {% if search_keyword %}
                        <input class="search-bar" name="search" value="{{search_keyword}}" type="text">
                    {% else %}
                        <input class="search-bar" name="search" placeholder="Find your knowledge-bases!" type="text">
                    {% endif %}

                    {# I want every information to be encoded in url. #}
                    {# In order to do that, this form must include all the information in the query. #}
                    <input name="sort_by" value="{{sort_by}}" type="text" style="display: none;">

                    <input class="submit-button" type="submit" value="Search">
                </div>
            </form>
        </div>
        <div class="flex-container-row-center">
            <div class="sort-by">
                {% for category in sort_categories %}
                    <a class={% if category.selected %}"selected-category"{% else %}"unselected-category"{% endif %} href="?sort_by={{category.short}}{{category.extra_query_string}}">{{category.long}}</a>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<div class="repo-list">
    <p>{{repositories|length}} Knowledge-bases</p>
    {% for repo in repositories %}
        <div class="repo-card">
            <div class="flex-container-lr">
                <div class="repo-title"><a href="/sample/{{repo.name}}">{{repo.name}}</a></div>
                <div class="repo-clone-count">
                    <svg width="24" height="24"><use href="#download-icon"></svg>
                    <span>total: {{repo.clone_total}}, weekly: {{repo.clone_weekly}}</span>
                </div>
            </div>
            <hr />
            <div class="repo-description">{{repo.description}}</div>
            <div class="repo-created-at">{{repo.created_at|render_time}}</div>
        </div>
    {% endfor %}

    {% if repositories | length == 0 %}
        {% if search_keyword %}
        <p>`{{search_keyword}}` did not match any knowledge-bases.</p>
        {% endif %}
    {% endif %}
</div>
{% endblock %}
